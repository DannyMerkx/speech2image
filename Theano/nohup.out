Can not use cuDNN on context None: cannot compile with cuDNN. We got this error:
b'/tmp/try_flags_djx5xk_1.c:4:19: fatal error: cudnn.h: No such file or directory\ncompilation terminated.\n'
Preallocating 11584/12193 Mb (0.950000) on cuda0
Mapped name None to device cuda0: Tesla P100-PCIE-12GB (0000:01:01.0)
Starting training...
epoch: 1
Epoch 1 of 50 took 277.585s
training loss:		252.908427
validation loss:		243.536225
recall@1 = 0.11160714285714285%
recall@5 = 0.5580357142857143%
recall@10 = 1.2276785714285714%
average rank= 433.434151786
epoch: 2
Epoch 2 of 50 took 277.048s
training loss:		217.259815
validation loss:		183.573667
recall@1 = 0.0%
recall@5 = 0.4464285714285714%
recall@10 = 1.7857142857142856%
average rank= 362.229910714
epoch: 3
Epoch 3 of 50 took 277.260s
training loss:		161.226436
validation loss:		153.707686
recall@1 = 0.4464285714285714%
recall@5 = 1.1160714285714286%
recall@10 = 2.1205357142857144%
average rank= 358.822544643
epoch: 4
Epoch 4 of 50 took 275.476s
training loss:		119.733210
validation loss:		130.198008
recall@1 = 0.11160714285714285%
recall@5 = 1.4508928571428572%
recall@10 = 2.7901785714285716%
average rank= 313.7890625
epoch: 5
Epoch 5 of 50 took 278.127s
training loss:		90.592422
validation loss:		92.943218
recall@1 = 0.2232142857142857%
recall@5 = 1.8973214285714284%
recall@10 = 3.2366071428571432%
average rank= 293.739955357
epoch: 6
Epoch 6 of 50 took 278.380s
training loss:		64.225739
validation loss:		78.125923
recall@1 = 0.33482142857142855%
recall@5 = 1.6741071428571428%
recall@10 = 3.3482142857142856%
average rank= 266.016741071
epoch: 7
Epoch 7 of 50 took 276.910s
training loss:		52.481293
validation loss:		88.218867
recall@1 = 0.78125%
recall@5 = 2.1205357142857144%
recall@10 = 3.571428571428571%
average rank= 286.733258929
epoch: 8
Epoch 8 of 50 took 275.777s
training loss:		41.994934
validation loss:		71.684658
recall@1 = 0.4464285714285714%
recall@5 = 2.5669642857142856%
recall@10 = 4.575892857142857%
average rank= 258.910714286
epoch: 9
Epoch 9 of 50 took 277.280s
training loss:		36.523376
validation loss:		61.844063
recall@1 = 0.78125%
recall@5 = 3.459821428571429%
recall@10 = 5.022321428571429%
average rank= 255.915178571
epoch: 10
Epoch 10 of 50 took 276.776s
training loss:		35.258523
validation loss:		62.409218
recall@1 = 1.1160714285714286%
recall@5 = 2.6785714285714284%
recall@10 = 5.580357142857143%
average rank= 260.642857143
epoch: 11
Epoch 11 of 50 took 277.047s
training loss:		27.513278
validation loss:		56.820112
recall@1 = 0.2232142857142857%
recall@5 = 2.455357142857143%
recall@10 = 4.6875%
average rank= 257.6015625
epoch: 12
Epoch 12 of 50 took 277.199s
training loss:		26.719399
validation loss:		59.423851
recall@1 = 0.5580357142857143%
recall@5 = 4.017857142857143%
recall@10 = 6.138392857142857%
average rank= 246.626116071
epoch: 13
Epoch 13 of 50 took 277.444s
training loss:		23.339406
validation loss:		58.275321
recall@1 = 0.8928571428571428%
recall@5 = 2.7901785714285716%
recall@10 = 5.133928571428571%
average rank= 228.521205357
epoch: 14
Epoch 14 of 50 took 276.569s
training loss:		19.350783
validation loss:		61.503111
recall@1 = 0.6696428571428571%
recall@5 = 2.455357142857143%
recall@10 = 4.6875%
average rank= 235.505580357
epoch: 15
Epoch 15 of 50 took 277.427s
training loss:		19.468196
validation loss:		61.594764
recall@1 = 0.4464285714285714%
recall@5 = 1.7857142857142856%
recall@10 = 4.910714285714286%
average rank= 242.206473214
epoch: 16
Epoch 16 of 50 took 276.784s
training loss:		16.420622
validation loss:		59.159108
recall@1 = 0.78125%
recall@5 = 3.459821428571429%
recall@10 = 6.584821428571429%
average rank= 236.975446429
epoch: 17
Epoch 17 of 50 took 276.946s
training loss:		15.912129
validation loss:		52.342828
recall@1 = 0.5580357142857143%
recall@5 = 3.7946428571428568%
recall@10 = 6.919642857142858%
average rank= 230.021205357
epoch: 18
Epoch 18 of 50 took 277.254s
training loss:		14.301096
validation loss:		55.712032
recall@1 = 0.2232142857142857%
recall@5 = 3.013392857142857%
recall@10 = 5.133928571428571%
average rank= 236.433035714
epoch: 19
Epoch 19 of 50 took 276.663s
training loss:		14.239613
validation loss:		53.228670
recall@1 = 0.4464285714285714%
recall@5 = 2.5669642857142856%
recall@10 = 4.910714285714286%
average rank= 234.177455357
epoch: 20
Epoch 20 of 50 took 276.506s
training loss:		12.681001
validation loss:		58.960209
recall@1 = 0.33482142857142855%
recall@5 = 2.232142857142857%
recall@10 = 5.357142857142857%
average rank= 239.697544643
epoch: 21
Epoch 21 of 50 took 276.222s
training loss:		13.368052
validation loss:		45.379147
recall@1 = 0.33482142857142855%
recall@5 = 2.1205357142857144%
recall@10 = 6.361607142857142%
average rank= 232.446428571
epoch: 22
Epoch 22 of 50 took 276.399s
training loss:		11.205084
validation loss:		51.693605
recall@1 = 0.5580357142857143%
recall@5 = 2.7901785714285716%
recall@10 = 6.138392857142857%
average rank= 232.922991071
epoch: 23
Epoch 23 of 50 took 277.419s
training loss:		10.814805
validation loss:		51.973557
recall@1 = 0.6696428571428571%
recall@5 = 3.571428571428571%
recall@10 = 6.696428571428571%
average rank= 237.176339286
epoch: 24
Epoch 24 of 50 took 276.153s
training loss:		11.124891
validation loss:		54.214154
recall@1 = 0.4464285714285714%
recall@5 = 3.2366071428571432%
recall@10 = 6.25%
average rank= 237.474330357
epoch: 25
Epoch 25 of 50 took 276.821s
training loss:		9.313957
validation loss:		47.671843
recall@1 = 0.4464285714285714%
recall@5 = 2.6785714285714284%
recall@10 = 4.129464285714286%
average rank= 233.831473214
epoch: 26
Epoch 26 of 50 took 277.474s
training loss:		9.060165
validation loss:		48.453977
recall@1 = 0.5580357142857143%
recall@5 = 4.017857142857143%
recall@10 = 7.2544642857142865%
average rank= 227.290178571
epoch: 27
Epoch 27 of 50 took 274.791s
training loss:		9.552286
validation loss:		53.347532
recall@1 = 0.33482142857142855%
recall@5 = 3.459821428571429%
recall@10 = 7.142857142857142%
average rank= 228.964285714
epoch: 28
Epoch 28 of 50 took 276.858s
training loss:		10.145759
validation loss:		53.198015
recall@1 = 0.5580357142857143%
recall@5 = 2.7901785714285716%
recall@10 = 6.361607142857142%
average rank= 235.183035714
epoch: 29
Epoch 29 of 50 took 276.308s
training loss:		8.757508
validation loss:		49.439185
recall@1 = 0.78125%
recall@5 = 3.459821428571429%
recall@10 = 5.46875%
average rank= 226.873883929
epoch: 30
Epoch 30 of 50 took 276.177s
training loss:		9.042165
validation loss:		48.352002
recall@1 = 0.6696428571428571%
recall@5 = 3.125%
recall@10 = 5.691964285714286%
average rank= 234.6875
epoch: 31
Epoch 31 of 50 took 276.226s
training loss:		8.687672
validation loss:		50.661146
recall@1 = 0.33482142857142855%
recall@5 = 2.5669642857142856%
recall@10 = 6.8080357142857135%
average rank= 228.166294643
epoch: 32
Epoch 32 of 50 took 276.951s
training loss:		8.688766
validation loss:		50.320566
recall@1 = 0.33482142857142855%
recall@5 = 3.2366071428571432%
recall@10 = 5.580357142857143%
average rank= 224.454241071
epoch: 33
Epoch 33 of 50 took 276.819s
training loss:		8.508669
validation loss:		54.991177
recall@1 = 0.5580357142857143%
recall@5 = 3.90625%
recall@10 = 6.4732142857142865%
average rank= 230.623883929
epoch: 34
Epoch 34 of 50 took 276.501s
training loss:		8.159558
validation loss:		52.689847
recall@1 = 1.1160714285714286%
recall@5 = 3.6830357142857144%
recall@10 = 6.696428571428571%
average rank= 234.087053571
epoch: 35
Epoch 35 of 50 took 276.918s
training loss:		8.043732
validation loss:		51.850622
recall@1 = 0.78125%
recall@5 = 2.6785714285714284%
recall@10 = 5.46875%
average rank= 230.763392857
epoch: 36
Epoch 36 of 50 took 276.845s
training loss:		8.369814
validation loss:		52.856950
recall@1 = 0.33482142857142855%
recall@5 = 3.571428571428571%
recall@10 = 6.026785714285714%
average rank= 232.015625
epoch: 37
Epoch 37 of 50 took 276.146s
training loss:		8.374118
validation loss:		51.736042
recall@1 = 0.5580357142857143%
recall@5 = 2.9017857142857144%
recall@10 = 5.245535714285714%
average rank= 235.564732143
epoch: 38
Epoch 38 of 50 took 276.506s
training loss:		8.593833
validation loss:		57.222348
recall@1 = 0.6696428571428571%
recall@5 = 4.129464285714286%
recall@10 = 7.142857142857142%
average rank= 224.044642857
epoch: 39
Epoch 39 of 50 took 277.153s
training loss:		8.219208
validation loss:		51.202208
recall@1 = 0.33482142857142855%
recall@5 = 3.459821428571429%
recall@10 = 6.696428571428571%
average rank= 230.015625
epoch: 40
Epoch 40 of 50 took 276.343s
training loss:		8.541626
validation loss:		57.397647
recall@1 = 0.5580357142857143%
recall@5 = 2.6785714285714284%
recall@10 = 5.915178571428571%
average rank= 226.858258929
epoch: 41
Epoch 41 of 50 took 276.273s
training loss:		7.838229
validation loss:		56.335575
recall@1 = 0.6696428571428571%
recall@5 = 4.017857142857143%
recall@10 = 6.026785714285714%
average rank= 233.357142857
epoch: 42
Epoch 42 of 50 took 276.432s
training loss:		8.845689
validation loss:		51.096176
recall@1 = 0.33482142857142855%
recall@5 = 3.459821428571429%
recall@10 = 6.4732142857142865%
average rank= 229.660714286
epoch: 43
Epoch 43 of 50 took 275.376s
training loss:		8.492119
validation loss:		57.984228
recall@1 = 0.2232142857142857%
recall@5 = 2.5669642857142856%
recall@10 = 5.915178571428571%
average rank= 228.720982143
epoch: 44
Epoch 44 of 50 took 276.890s
training loss:		7.470803
validation loss:		51.289242
recall@1 = 0.33482142857142855%
recall@5 = 3.571428571428571%
recall@10 = 6.138392857142857%
average rank= 235.168526786
epoch: 45
Epoch 45 of 50 took 276.403s
training loss:		7.513749
validation loss:		43.728692
recall@1 = 0.78125%
recall@5 = 4.129464285714286%
recall@10 = 6.361607142857142%
average rank= 225.265625
epoch: 46
Epoch 46 of 50 took 274.621s
training loss:		6.948231
validation loss:		52.795574
recall@1 = 0.8928571428571428%
recall@5 = 3.571428571428571%
recall@10 = 6.25%
average rank= 226.587053571
epoch: 47
Epoch 47 of 50 took 275.671s
training loss:		7.955935
validation loss:		54.687028
recall@1 = 0.6696428571428571%
recall@5 = 3.125%
recall@10 = 5.915178571428571%
average rank= 226.991071429
epoch: 48
Epoch 48 of 50 took 276.190s
training loss:		8.176248
validation loss:		60.592281
recall@1 = 0.4464285714285714%
recall@5 = 2.34375%
recall@10 = 5.133928571428571%
average rank= 234.565848214
epoch: 49
Epoch 49 of 50 took 274.902s
training loss:		7.335702
validation loss:		59.454811
recall@1 = 0.78125%
recall@5 = 3.013392857142857%
recall@10 = 4.910714285714286%
average rank= 235.988839286
epoch: 50
Epoch 50 of 50 took 276.499s
training loss:		7.716516
validation loss:		51.988708
recall@1 = 0.33482142857142855%
recall@5 = 3.2366071428571432%
recall@10 = 5.803571428571429%
average rank= 235.290178571
computing test accuracy
Final results:
  test loss:			57.577784
Test recall@1 = 0.5580357142857143%
Test recall@5 = 3.459821428571429%
Test recall@10 = 7.477678571428571%
Test average rank= 233.8046875
Closing remaining open files:/prep_data/flickr_features.h5...done
